# LLM ???????

????????? `freqtrade/scripts/freqai_expression_agent.py` ? `freqtrade/scripts/freqai_auto_agent.py` ???????(LLM)?????????,?????? FreqAI ??????

## 1. ?? LLM API

1. ? `.env` ???:
   ```ini
   LLM_BASE_URL=https://api.zhizengzeng.com/v1
   LLM_MODEL=gpt-3.5-turbo
   LLM_API_KEY=<YOUR_API_KEY>
   ```
2. ?????????? `--llm-base-url/--llm-api-key/--llm-model`?

## 2. ????(???)???

```powershell
conda run --no-capture-output -n freqtrade   python freqtrade/scripts/freqai_expression_agent.py     --feature-file user_data/freqai_features.json     --output user_data/freqai_expressions.json     --timeframe 1h     --llm-count 10     --llm-loops 12
```

- ???? LLM;?????? `--no-llm`?
- `--llm-loops` ????????????,`--llm-fallback` ?????????/?????
- ?????????? 5 ???,??????? `user_data/freqai_expressions_augmented.json`,??? LLM ??? zscore????EMA?????????,?? 50 ????????

## 3. ?????? + ??? + ??

```powershell
conda run --no-capture-output -n freqtrade   python freqtrade/scripts/freqai_auto_agent.py     --config freqtrade/user_data/config_freqai.json     --timeframe 1h     --top-expressions 40     --expression-combo-top 5
```

????:
1. ???????????,?? `user_data/freqai_features.json`(??? datadir)?
2. ?? LLM ???????,????? `user_data/freqai_expressions.json`?
3. ??????????? `freqtrade backtesting`?
4. ?????? `user_data/backtest_results/auto_agent/<timestamp>/`?
5. ???????????????????

??????:
```
[llm] request 50 expressions from gpt-3.5-turbo
[llm] tokens prompt=2727 completion=529
[llm] valid expressions 5
[summary] FreqAIExampleStrategy ????: 49, ???: -8.5543, ??: 40.82%
[??] ??????: user_dataacktest_resultsuto_agentÂ‚50928-034328acktest-result-2025-09-27_16-25-24.zip
```

## 4. ?? 50 ??????

```powershell
conda run --no-capture-output -n freqtrade   python freqtrade/scripts/freqai_expression_sweeper.py     --config freqtrade/user_data/config_freqai.json     --timeframe 1h     --expressions user_data/freqai_expressions_augmented.json     --limit 50
```

- ?????? `user_data/backtest_results/expr_sweeper/<timestamp>/summary.json`,???????
- ???????????,??????????????????????,???????/????

## 5. ????

- `ModuleNotFoundError: talib`:?? `freqtrade` ????????
- `?????????`:???????,??? `user_data/backtest_results/.last_result.json`?
- ??????:??? `--llm-loops` ??? `--llm-fallback` ????/????????
