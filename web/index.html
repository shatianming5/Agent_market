<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Agent Market Flow (MVP)</title>
    <link rel="stylesheet" href="https://unpkg.com/reactflow@11.10.2/dist/style.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="header">
      <div class="brand">
        <i class="ri-flow-chart"></i>
        <span>Agent Market Flow</span>
      </div>
      <div class="toolbar">
        <button id="btnLayout" title="自动布局"><i class="ri-mind-map"></i> 布局</button>
        <button id="btnAlignX" title="水平对齐"><i class="ri-align-center"></i> 对齐X</button>
        <button id="btnAlignY" title="垂直对齐"><i class="ri-align-left"></i> 对齐Y</button>
        <button id="btnSnap" title="网格吸附"><i class="ri-grid-line"></i> 吸附</button>
        <input id="gridSize" type="number" value="16" title="网格大小(px)" style="width:70px"/>
        <select id="snapStrength" title="吸附强度">
          <option value="medium">中</option>
          <option value="strong">强</option>
          <option value="weak">弱</option>
        </select>
        <button id="btnFit" title="适配视图"><i class="ri-focus-2-line"></i> 适配</button>
        <button id="btnClear" title="清理画布"><i class="ri-eraser-line"></i> 清理</button>
        <select id="brandSelect" title="品牌主题">
          <option value="ocean">Ocean</option>
          <option value="forest">Forest</option>
          <option value="sunset">Sunset</option>
        </select>
        <button id="btnTheme" title="切换主题"><i class="ri-contrast-2-line"></i> 主题</button>
        <button id="btnExport" title="导出画布"><i class="ri-image-2-line"></i> 导出</button>
        <button id="btnDistX" title="横向均匀分布"><i class="ri-swap-line"></i> 均匀X</button>
        <button id="btnDistY" title="纵向均匀分布"><i class="ri-swap-column-line"></i> 均匀Y</button>
      </div>
    </div>
    <div id="app">
      <div class="sidebar">
        <h3>流程构建</h3>
        <div class="node-palette">
          <div class="palette-title">拖到画布来创建节点</div>
          <div class="palette-list">
            <div class="palette-item" draggable="true" data-nodetype="data"><i class="ri-database-2-line"></i> 数据 Data</div>
            <div class="palette-item" draggable="true" data-nodetype="expr"><i class="ri-function-line"></i> 表达式 LLM</div>
            <div class="palette-item" draggable="true" data-nodetype="bt"><i class="ri-line-chart-line"></i> 回测 Backtest</div>
            <div class="palette-item" draggable="true" data-nodetype="ml"><i class="ri-cpu-line"></i> 训练 ML</div>
            <div class="palette-item" draggable="true" data-nodetype="rl"><i class="ri-brain-line"></i> 训练 RL</div>
            <div class="palette-item" draggable="true" data-nodetype="fb"><i class="ri-feedback-line"></i> 反馈 Feedback</div>
            <div class="palette-item" draggable="true" data-nodetype="ho"><i class="ri-sliders-2-line"></i> 超参 Hyperopt</div>
            <div class="palette-item" draggable="true" data-nodetype="mv"><i class="ri-shuffle-line"></i> 多区间验证</div>
          </div>
        </div>
        

        <h4>选中节点配置</h4>
        <div id="nodeForm" class="panel"></div>

        <h3 style="margin-top:14px">快速参数</h3>
        <div>
          <label>Config</label>
          <input id="cfg" value="configs/config_freqai_multi.json" />
        </div>
        <div>
          <label>Feature File</label>
          <input id="featureFile" value="user_data/freqai_features_multi.json" />
        </div>
        <div>
          <label>Timeframe</label>
          <input id="timeframe" value="4h" />
        </div>
        <div>
          <label>LLM Model</label>
          <input id="llmModel" value="gpt-3.5-turbo" />
        </div>
        <div>
          <label>LLM Count</label>
          <input id="llmCount" type="number" value="3" />
        </div>
        <div>
          <label>Timerange</label>
          <input id="timerange" value="20210101-20210331" />
        </div>
        <div class="buttons">
          <button id="btnExpr">运行表达式(LLM)</button>
          <button id="btnBacktest">运行回测</button>
          <button id="btnSummary">查看摘要</button>
        </div>
        <div class="summary" id="summary"></div>
        <div id="chart" style="height:240px;margin-top:8px;"></div>
        <h4>特征 TopN</h4>
        <div class="buttons" style="margin-bottom:6px; gap:6px">
          <button id="btnFeatTop">查看TopN</button>
          <button id="btnFeatPlot">绘制柱状图</button>
        </div>
        <div id="featTop" class="panel"></div>
        <div id="featChart" style="height:220px;margin:6px 0 12px 0;"></div>
        <h4>Agent Flow（后端）</h4>
        <div class="buttons" style="gap:6px; display:flex; flex-direction:column; align-items:stretch;">
          <input id="flowCfg" value="configs/agent_flow_multi.json" />
          <input id="flowSteps" placeholder="可选：feature expression ml rl backtest（空=全流程）" />
          <button id="btnRunAgentFlow">运行后端Flow</button>
        </div>
        <h4>回测对比</h4>
        <div class="buttons" style="gap:4px; display:flex; flex-direction:column; align-items:stretch;">
          <button id="btnList">加载结果列表</button>
          <input id="resA" placeholder="结果A文件名" />
          <input id="resB" placeholder="结果B文件名" />
          <button id="btnCompare">对比</button>
        </div>
        <div id="comparePanel" class="panel"></div>
        <h4>多区间验证结果</h4>
        <div id="mvPanel" class="panel"></div>
      </div>
      <div class="canvas">
        <div id="root" style="width:100%;height:100%"></div>
      </div>
      <div class="logs">
        <h3>日志</h3>
        <div class="cards" id="cards"></div>
        <pre id="logs"></pre>
      </div>
    </div>
    <div id="ctxMenu" class="ctx-menu" style="display:none"></div>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/reactflow@11.10.2/dist/reactflow.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
    <script src="https://unpkg.com/dagre@0.8.5/dist/dagre.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="app.js"></script>
  </body>
  </html>



